---
page_id: 18c6e4e1-bfbf-44b4-845c-011ad82fc82d
title: Test passwordless flows
description: "Guide to testing passwordless authentication flows with Cypress with Mailosaur."
sidebar:
  order: 3
topics:
  - developer-tools
  - testing
  - cypress
  - e2e-testing
  - passwordless
sdk: []
languages:
  - JavaScript
  - TypeScript
audience: developers
complexity: intermediate
keywords:
  - cypress
  - testing
  - passwordless
  - magic link
  - email OTP
  - Mailosaur
updated: 2026-01-20
featured: false
deprecated: false
---

This guide shows you how to automate passwordless authentication testing with Cypress using Mailosaur.

### What you need 

- Completed the [Cypress setup](/testing/cypress/)
- A [test user and application](/testing/setup-test-user-environment/)
- A [Mailosaur](https://mailosaur.com/) account (Sign up for free trial)

## Setup Mailosaur

1. Sign in to your Mailosaur account.
2. Copy the **Server ID** from the dashboard.
3. Go to **API Keys** > select **Create standard key** and copy the value.
4. Install the Mailosaur client in your Cypress project:

    ```bash
    npm install mailosaur --save-dev
    ```

5. Update your `cypress.env.json` file with your Mailosaur API key and Server ID:

    ```json
    {
      // ...your other environment variables...
      "MAILOSAUR_API_KEY": "your-api-key",
      "MAILOSAUR_SERVER_ID": "your-server-id"
    }
    ```


6. Create a Cypress command file`cypress/support/commands.ts`:

    ```bash
    mkdir -p cypress/support
    touch cypress/support/commands.ts
    ```
7. Add the following code to `commands.ts`:

    ```ts
    // cypress/support/commands.ts
    import MailosaurClient from 'mailosaur'

    declare global {
      namespace Cypress {
        interface Chainable {
          getOTPFromEmail(email: string): Chainable<string>
        }
      }
    }

    Cypress.Commands.add('getOTPFromEmail', (email: string) => {
      const mailosaur = new MailosaurClient(Cypress.env('MAILOSAUR_API_KEY'))
      const serverId = Cypress.env('MAILOSAUR_SERVER_ID')

      return cy.wrap(
        mailosaur.messages.get(serverId, { sentTo: email }).then((email) => {
          const otpMatch = email.text?.body?.match(/\b(\d{6})\b/)
          const otpCode = otpMatch?.[1]
          
          if (!otpCode) {
            throw new Error('Could not extract OTP code from email')
          }
          
          return otpCode
        })
      )
    })
    ```

## Test passwordless sign-up flow

To test the passwordless sign-up flow, make sure the **Email + code** option is enabled in Authentication methods in your Kinde application.

Use the following code:

    ```typescript
    // cypress/e2e/passwordless-signup.cy.ts
    describe('Passwordless Authentication Flows', () => {
      const serverId = Cypress.env('MAILOSAUR_SERVER_ID')

      it('user can sign up with email and code', () => {
        // Generate unique email for this test run
        const timestamp = Date.now()
        const testEmail = `test-${timestamp}@${serverId}.mailosaur.net`

        cy.visit(Cypress.env('TEST_APP_URL'))
        cy.get('[data-testid="sign-up-button"]').click()

        // Wait for Kinde sign-up page
        cy.url().should('include', 'kinde.com')

        // Fill sign-up form
        cy.origin(Cypress.env('KINDE_ISSUER_URL'), { args: { testEmail } }, ({ testEmail }) => {
          cy.get('input[name="p_first_name"]').type('John')
          cy.get('input[name="p_last_name"]').type('Doe')
          cy.get('input[name="p_email"]').type(testEmail)
          cy.get('input[name="p_has_clickwrap_accepted"]').check() // Accept terms and conditions
          cy.get('button[type="submit"]').click()
        })

        // Wait for OTP email and extract code
        cy.getOTPFromEmail(testEmail).then((otpCode) => {
          cy.origin(Cypress.env('KINDE_ISSUER_URL'), { args: { otpCode } }, ({ otpCode }) => {
            cy.get('input[name="p_confirmation_code"]').type(otpCode)
            cy.get('button[type="submit"]').click()
          })
        })

        // Wait for successful auth
        cy.url().should('include', new URL(Cypress.env('TEST_APP_URL')).hostname)
        cy.get('[data-testid="user-profile"]').should('be.visible')
      })
    })
    ```

## Test passwordless sign-in flow

To test the passwordless sign-in flow:

1. Enable the **Email + code** option in Authentication methods. 
2. Sign up for a new test user using the Mailosaur domain (e.g, test-123@your-server-id.mailosaur.net).
3. Save the test user email to your `cypress.env.json` file as `TEST_USER_EMAIL`.
4. Use the following code:

    ```ts
    // cypress/e2e/passwordless-signin.cy.ts
    describe('Passwordless Authentication Flows', () => {
      it('user can sign in with email and code', () => {
        cy.visit(Cypress.env('TEST_APP_URL'))
        cy.get('[data-testid="sign-in-button"]').click()

        // Wait for Kinde sign-in page
        cy.url().should('include', 'kinde.com')

        // Fill sign-in form
        cy.origin(Cypress.env('KINDE_ISSUER_URL'), () => {
          cy.get('input[name="p_email"]').type(Cypress.env('TEST_USER_EMAIL'))
          cy.get('button[type="submit"]').click()
        })

        // Wait for OTP email and extract code
        cy.getOTPFromEmail(Cypress.env('TEST_USER_EMAIL')).then((otpCode) => {
          cy.origin(Cypress.env('KINDE_ISSUER_URL'), { args: { otpCode } }, ({ otpCode }) => {
            cy.get('input[name="p_confirmation_code"]').type(otpCode)
            cy.get('button[type="submit"]').click()
          })
        })

        // Wait for successful auth
        cy.url().should('include', new URL(Cypress.env('TEST_APP_URL')).hostname)
        cy.get('[data-testid="user-profile"]').should('be.visible')
      })
    })
    ```

## Test sign-up flow with email and password

We have included this example because OTP verification is required for all new users in Kinde regardless of the authentication method used.

This example uses the Kinde **email + password** authentication method to sign up a new test user:

```ts
// cypress/e2e/email-password-signup.cy.ts
describe('Authentication Flows', () => {
  const serverId = Cypress.env('MAILOSAUR_SERVER_ID')

  it('user can sign up with email and password', () => {
    // Generate unique email for this test run
    const timestamp = Date.now()
    const testEmail = `test-${timestamp}@${serverId}.mailosaur.net`

    cy.visit(Cypress.env('TEST_APP_URL'))
    cy.get('[data-testid="sign-up-button"]').click()

    // Wait for Kinde sign-up page
    cy.url().should('include', 'kinde.com')

    // Fill sign-up form
    cy.origin(Cypress.env('KINDE_ISSUER_URL'), { args: { testEmail } }, ({ testEmail }) => {
      cy.get('input[name="p_first_name"]').type('John')
      cy.get('input[name="p_last_name"]').type('Doe')
      cy.get('input[name="p_email"]').type(testEmail)
      cy.get('input[name="p_has_clickwrap_accepted"]').check() // Accept terms and conditions
      cy.get('button[type="submit"]').click()
    })

    // Wait for OTP email
    cy.getOTPFromEmail(testEmail).then((otpCode) => {
      cy.origin(Cypress.env('KINDE_ISSUER_URL'), { args: { otpCode } }, ({ otpCode }) => {
        cy.get('input[name="p_confirmation_code"]').type(otpCode)
        cy.get('button[type="submit"]').click()
      })
    })

    // Enter password
    cy.origin(Cypress.env('KINDE_ISSUER_URL'), () => {
      cy.get('input[name="p_first_password"]').type(Cypress.env('TEST_USER_PASSWORD')!)
      cy.get('input[name="p_second_password"]').type(Cypress.env('TEST_USER_PASSWORD')!)
      cy.get('button[type="submit"]').click()
    })

    // Wait for successful auth
    cy.url().should('include', new URL(Cypress.env('TEST_APP_URL')).hostname)
    cy.get('[data-testid="user-profile"]').should('be.visible')
  })
})
```

## Running the tests

1. Use the following command to run the tests:

    ```bash
    npx cypress open
    ```

    You should see the test pass.

2. Go to your Kinde dashboard > **Users** to find the test users you created.

## Best practices

1. **Use dedicated test email addresses**: Create separate email addresses for each test run to avoid conflicts
2. **Add retry logic**: Email delivery can be delayed; add polling with timeouts
3. **Clean up emails**: Delete test emails after use to keep inboxes clean
4. **Handle timeouts gracefully**: Set reasonable timeouts and provide clear error messages
5. **Extract OTP reliably**: Use regex patterns that match your OTP format (typically 6 digits)
6. **Secure credentials**: Store email service API keys in environment variables or secret managers
7. **Use cy.origin() for cross-origin**: Always use `cy.origin()` when interacting with Kinde's domain

## What's not supported

The following limitations apply to passwordless flow testing:

- **Real email addresses**: Testing with real email addresses requires manual code entry (use test email services instead)
- **SMS OTP**: This guide focuses on email OTP; SMS OTP testing requires different approaches
- **Rate limiting**: Some email services have rate limits; plan test execution accordingly
