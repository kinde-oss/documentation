---
page_id: c1b1ea81-35f9-467e-8079-042d6a786e55
title: Testing authentication flows
description: "Guide to testing sign-up, sign-in, and sign-out flows using browser automation tools like Playwright, Cypress, and AWS CloudWatch Synthetic Canaries."
sidebar:
  order: 4
relatedArticles:
  - 4882de7b-07f3-4cc8-ac01-b096e17dcc35
  - f38ed786-7234-44d1-a564-f7269ce536c5
  - a1b2c3d4-e5f6-7890-abcd-ef1234567890
topics:
  - developer-tools
  - testing
  - ui-testing
  - e2e-testing
  - authentication
sdk: []
languages:
  - JavaScript
  - TypeScript
audience: developers
complexity: intermediate
keywords:
  - UI testing
  - authentication flows
  - sign-up testing
  - sign-in testing
  - sign-out testing
  - Playwright
  - Cypress
  - AWS CloudWatch
  - puppeteer
  - browser automation
updated: 2025-12-30
featured: false
deprecated: false
ai_summary: Guide to testing authentication flows (sign-up, sign-in, sign-out) using browser automation tools including Playwright, Cypress, and AWS CloudWatch Synthetic Canaries.
---

Authentication is critical, and when it breaks, users can't access your product. This guide shows you how to test Kinde authentication flows using browser automation tools like Playwright, Cypress, and AWS CloudWatch Synthetic Canaries. You'll learn how to automate sign-up, sign-in, and sign-out flows, test error scenarios, and verify session management.

### What you need

- A test user with email and password created in the [test user and environment setup](/developer-tools/testing/setup-test-user-environment/) guide.
- A running test application with `testid` attributes such as the [Kinde Next.js test application](https://github.com/tamalchowdhury/kinde-test-application).
- [Node.js](https://nodejs.org/en/download/) version 20 or higher.

## Tool comparison

Different browser automation tools offer various trade-offs. Here's a comparison:

| Method | Pros | Cons |
| --- | --- | --- |
| **AWS Synthetic Canaries** | Native AWS integration, scheduled runs, built-in metrics | Higher cost per execution |
| **Playwright (self-hosted)** | Modern API, cross-browser support, free | Requires CI/CD setup |
| **Cypress Cloud** | Great DX, parallel execution | Subscription cost |
| **Self-hosted Puppeteer** | Lower cost, full control | Requires infrastructure management |

## Testing sign-up flows

Kinde requires OTP email verification when signing up for a new user. See the [Testing Passwordless Flows](/developer-tools/testing/testing-passwordless-flows/) guide for details on how to handle OTP verification in your test methods.

When testing sign-up flows, ensure:

1. **Test user doesn't exist**: Use unique email addresses for each test run (e.g., `test-${timestamp}@example.com`)
2. **Handle email verification**: Use an email testing service to test user sign up
3. **Verify redirect**: Check that users are redirected to the correct page after sign-up
4. **Test error cases**: Test with invalid emails, weak passwords, etc.

### General pattern

The typical sign-up flow involves:

1. Navigate to your application
2. Click the sign-up button (redirects to Kinde)
3. Fill in email and password on the Kinde sign-up page
4. Submit the form
5. Handle OTP email verification (extract code from email and enter it)
6. Wait for redirect back to your application
7. Verify the user is authenticated

**Key selectors to use:**
- First name input: `input[name="p_first_name"]`
- Last name input: `input[name="p_last_name"]`
- Email input: `input[name="p_email"]`
- Password input: `input[name="p_first_password"]` 
- Password confirmation: `input[name="p_second_password"]`
- Terms and conditions checkbox: `input[name="p_has_clickwrap_accepted"]`
- OTP input: `input[name="p_confirmation_code"]`
- Submit button: `button[type="submit"]`

## Testing sign-in flows

For sign-in flows:

1. **Use existing test user**: Create a verified test user beforehand
2. **Test both success and failure**: Test valid credentials and invalid credentials
3. **Verify session**: Ensure the user is properly authenticated after sign-in
4. **Test redirects**: Verify redirects to intended pages

### General pattern

The typical sign-in flow involves:

1. Navigate to your application
2. Click the sign-in button (redirects to Kinde)
3. Enter email and submit
4. Enter password and submit
5. Wait for redirect back to your application
6. Verify the user is authenticated

**Error handling:**
- Test with invalid credentials
- Verify error messages are displayed
- Ensure users remain on the login page after errors

## Testing sign-out flows

Test that sign-out:

1. **Clears session**: User is no longer authenticated
2. **Redirects correctly**: User is redirected to the intended page
3. **Protects routes**: Protected routes are no longer accessible

### General pattern

The typical sign-out flow involves:

1. Authenticate the user first
2. Click the sign-out button
3. Verify the user is signed out (sign-in button visible)
4. Attempt to access protected routes
5. Verify redirect to sign-in page

## Example: Playwright

1. Install Playwright with the following command:
    ```bash
    npm init playwright@latest
    ```
2. Install dotenv with the following command:
    ```bash
    npm install dotenv --save-dev
    ```
3. Edit the `playwright.config.ts` file to add the following:
    ```ts
    // playwright.config.ts
    import dotenv from 'dotenv';
    import path from 'path';
    dotenv.config({ path: path.resolve(__dirname, '.env') });
    // ... other config file content ...
    ```
4. Create a new `.env` file:
    ```bash
    touch .env
    ```
5. Add the following to the `.env` file:
    ```env
    TEST_APP_URL=https://your-app-url.com
    TEST_USER_EMAIL=test@example.com
    TEST_USER_PASSWORD=your-test-password
    ```

    <Aside type="warning" title="Important">
      Make sure to add the `.env` file to your `.gitignore` file to prevent committing sensitive information to source control.
    </Aside>

6. Create a new test file:
    ```bash
    touch tests/auth.spec.ts
    ```
7. Add the following to the `auth.spec.ts` file:

    ```ts
    // tests/auth.spec.ts
    import { test, expect } from '@playwright/test';

    test.describe('Authentication Flows', () => {

      test('user can sign in with email and password', async ({ page }) => {
        await page.goto(process.env.TEST_APP_URL!);
        await page.click('[data-testid="sign-in-button"]');

        // Wait for Kinde login page
        await expect(page).toHaveURL(/kinde\.com/);

        // Enter credentials
        await page.fill('input[name="p_email"]', process.env.TEST_USER_EMAIL!);
        await page.click('button[type="submit"]');

        await page.fill('input[name="p_password"]', process.env.TEST_USER_PASSWORD!);
        await page.click('button[type="submit"]');

        // Wait for redirect back to app
        const appUrl = new URL(process.env.TEST_APP_URL!);
        await expect(page).toHaveURL(new RegExp(appUrl.hostname.replace('.', '\\.')));
        await expect(page.locator('[data-testid="user-profile"]')).toBeVisible();
      });

      test('user can sign out', async ({ page }) => {
        // First authenticate
        await page.goto(process.env.TEST_APP_URL!);
        await page.click('[data-testid="sign-in-button"]');
        await page.fill('input[name="p_email"]', process.env.TEST_USER_EMAIL!);
        await page.click('button[type="submit"]');
        await page.fill('input[name="p_password"]', process.env.TEST_USER_PASSWORD!);
        await page.click('button[type="submit"]');
        const appUrl = new URL(process.env.TEST_APP_URL!);
        await expect(page).toHaveURL(new RegExp(appUrl.hostname.replace('.', '\\.')));

        // Now sign out
        await page.click('[data-testid="sign-out-button"]');

        // Should show signed-out state
        await expect(page.locator('[data-testid="sign-in-button"]')).toBeVisible();
      });
    });
    ```
8. Run the Playwright tests in ui mode:
    ```bash
    npx playwright test --ui
    ```

    You should now see the Playwright tests in the browser.

    ![Playwright tests passed](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/49ecd595-d9ef-409c-63bd-a8b7236e3300/public)

### Example: Sign up flow with Playwright

Check out the full working example in the [Testing Passwordless Flows](/developer-tools/testing/testing-passwordless-flows/) guide.

```ts
// tests/email-password-signup.spec.ts
import { test, expect } from '@playwright/test'
import MailosaurClient from 'mailosaur'
require('dotenv').config()

const mailosaur = new MailosaurClient(process.env.MAILOSAUR_API_KEY!)
const serverId = process.env.MAILOSAUR_SERVER_ID!

test.describe('Authentication Flows', () => {
  test('user can sign up with email and password', async ({ page }) => {
    // Generate unique email for this test run
    const timestamp = Date.now()
    const testEmail = `test-${timestamp}@${serverId}.mailosaur.net`

    await page.goto(process.env.TEST_APP_URL!)
    await page.click('[data-testid="sign-up-button"]')

    // Wait for Kinde sign-up page
    await expect(page).toHaveURL(/kinde\.com/)

    // Fill sign-up form
    await page.fill('input[name="p_first_name"]', 'John')
    await page.fill('input[name="p_last_name"]', 'Doe')
    await page.fill('input[name="p_email"]', testEmail)
    await page.check('input[name="p_has_clickwrap_accepted"]') // Accept terms and conditions
    await page.click('button[type="submit"]')

    // Wait for OTP email
    const email = await mailosaur.messages.get(serverId, {
      sentTo: testEmail,
    })

    // Extract 6-digit OTP code from email
    const otpMatch = email.text?.body?.match(/\b(\d{6})\b/)
    const otpCode = otpMatch?.[1]

    if (!otpCode) {
      throw new Error('Could not extract OTP code from email')
    }

    // Enter OTP
    await page.fill('input[name="p_confirmation_code"]', otpCode)
    await page.click('button[type="submit"]')

    // Enter password
    await page.fill(
      'input[name="p_first_password"]',
      process.env.TEST_USER_PASSWORD!
    )
    await page.fill(
      'input[name="p_second_password"]',
      process.env.TEST_USER_PASSWORD!
    )
    await page.click('button[type="submit"]')

    // Wait for successful auth
    const appUrl = new URL(process.env.TEST_APP_URL!)
    await expect(page).toHaveURL(
      new RegExp(appUrl.hostname.replace('.', '\\.'))
    )
    await expect(page.locator('[data-testid="user-profile"]')).toBeVisible()

    // Save state
    await page.context().storageState({ path: 'playwright/.auth/user.json' })

    // Clean up - delete the email
    await mailosaur.messages.del(email.id!)
  })
})
```

## Example: Cypress

1. Install Cypress with the following command:
    ```bash
    npm install cypress --save-dev
    ```
2. Run Cypress configuration wizard and follow the setup:
    ```bash
    npx cypress open
    ```
3. Create the Cypress env file:
    ```bash
    touch cypress.env.json
    ```
4. Add the following to the `cypress.env.json` file:
    ```json
    {
      "TEST_APP_URL": "https://your-app-url.com",
      "TEST_USER_EMAIL": "test@example.com",
      "TEST_USER_PASSWORD": "your-test-password",
      "KINDE_ISSUER_URL": "https://YOUR_KINDE_DOMAIN.kinde.com"
    }
    ```
    <Aside type="warning" title="Important">
      Make sure to add the `cypress.env.json` file to your `.gitignore` file to prevent committing sensitive information to source control.
    </Aside>
5. Add the following to the `spec.cy.js` file:
    ```js
    // spec.cy.js
    describe('Authentication Flows', () => {
      it('user can sign in with email and password', () => {
        cy.visit(Cypress.env('TEST_APP_URL'))
        cy.get('[data-testid="sign-in-button"]').click()

        // Wait for Kinde login page
        cy.url().should('include', 'kinde.com')

        cy.origin(Cypress.env('KINDE_ISSUER_URL'), () => {
          // Enter credentials
          cy.get('input[name="p_email"]').type(Cypress.env('TEST_USER_EMAIL'))
          cy.get('button[type="submit"]').click()

          cy.get('input[name="p_password"]').type(Cypress.env('TEST_USER_PASSWORD'))
          cy.get('button[type="submit"]').click({ multiple: true })
        })
        // Wait for redirect back to app
        cy.url().should('include', new URL(Cypress.env('TEST_APP_URL')).hostname)
        cy.get('[data-testid="user-profile"]').should('be.visible')
      })

      it('user can sign out', () => {
        // First authenticate (or use cy.session for state reuse)
        cy.visit(Cypress.env('TEST_APP_URL'))
        cy.get('[data-testid="sign-in-button"]').click()
        cy.origin(Cypress.env('KINDE_ISSUER_URL'), () => {
          // Enter credentials
          cy.get('input[name="p_email"]').type(Cypress.env('TEST_USER_EMAIL'))
          cy.get('button[type="submit"]').click()

          cy.get('input[name="p_password"]').type(Cypress.env('TEST_USER_PASSWORD'))
          cy.get('button[type="submit"]').click({ multiple: true })
        })
        cy.url().should('include', new URL(Cypress.env('TEST_APP_URL')).hostname)

        // Now sign out
        cy.get('[data-testid="sign-out-button"]').click()

        // Should show signed-out state
        cy.get('[data-testid="sign-in-button"]').should('be.visible')
      })
    })
    ```
6. Run the Cypress tests:
    ```bash
    npx cypress open
    ```

    You should now see the Cypress tests in the browser.

    ![Cypress tests passed](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/f652e891-5863-402d-ec3d-16576792a600/public)

### Example: Sign up flow with Cypress

```ts
// spec.cy.ts
describe('Authentication Flows', () => {
  it('user can sign up with email and password', () => {
      // Generate unique email for this test run
      const timestamp = Date.now();
      const testEmail = `test-${timestamp}@testemail.com`;
      
      cy.visit(Cypress.env('TEST_APP_URL'));
      cy.get('[data-testid="sign-up-button"]').click();
      
      // Wait for Kinde sign-up page
      cy.url().should('include', 'kinde.com');
      
      // Fill sign-up form
      cy.origin(Cypress.env('KINDE_ISSUER_URL'), { args: { testEmail } }, ({ testEmail }) => {
          cy.get('input[name="p_first_name"]').type('John');
          cy.get('input[name="p_last_name"]').type('Doe');
          cy.get('input[name="p_email"]').type(testEmail);
          cy.get('input[name="p_has_clickwrap_accepted"]').check(); // Accept terms and conditions
          cy.get('button[type="submit"]').click();
      });

      // Handle OTP email verification in this step
      // See Testing Passwordless Flows guide for email service integration
      
      cy.origin(Cypress.env('KINDE_ISSUER_URL'), () => {
        cy.get('input[name="p_first_password"]').type(Cypress.env('TEST_USER_PASSWORD')!)
        cy.get('input[name="p_second_password"]').type(Cypress.env('TEST_USER_PASSWORD')!)
        cy.get('button[type="submit"]').click();
      });
      
      // Wait for redirect back to app
      cy.url().should('include', new URL(Cypress.env('TEST_APP_URL')).hostname);
      cy.get('[data-testid="user-profile"]').should('be.visible');
    });
});
```

## Example: AWS CloudWatch Synthetic Canaries

Here's a pattern using AWS CloudWatch Synthetic Canaries with Puppeteer:

```js
// Synthetic canary script
const synthetics = require('Synthetics');

const flowStep = async (stepName, action) => {
  await synthetics.executeStep(stepName, action);
};

exports.handler = async () => {
  const page = await synthetics.getPage();
  
  // Store testEmail outside flowStep for OTP handling
  let testEmail;

  // Sign-up flow
  await flowStep('Open app for sign-up', async () => {
    await page.goto(process.env.TEST_APP_URL, { 
      waitUntil: 'networkidle0', 
      timeout: 30000 
    });
  });

  await flowStep('Click sign up', async () => {
    await page.waitForSelector('[data-testid="sign-up-button"]', { timeout: 10000 });
    await page.click('[data-testid="sign-up-button"]');
    // Wait for navigation to Kinde
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Fill sign-up form', async () => {
    const timestamp = Date.now();
    testEmail = `test-${timestamp}@testemail.com`;
    
    await page.waitForSelector('input[name="p_first_name"]', { timeout: 10000 });
    await page.fill('input[name="p_first_name"]', 'John');
    await page.fill('input[name="p_last_name"]', 'Doe');
    await page.fill('input[name="p_email"]', testEmail);
    await page.click('input[name="p_has_clickwrap_accepted"]'); // Use click() instead of check()
    await page.click('button[type="submit"]');
    // Wait for OTP page
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Handle OTP verification', async () => {
    // Handle OTP email verification in this step
    // See Testing Passwordless Flows guide for email service integration
    // Example: const otpCode = await getOTPFromEmail(testEmail);
    // await page.fill('input[name="p_confirmation_code"]', otpCode);
    // await page.click('button[type="submit"]');
    // await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Create password', async () => {
    await page.waitForSelector('input[name="p_first_password"]', { timeout: 10000 });
    await page.fill('input[name="p_first_password"]', process.env.TEST_USER_PASSWORD);
    await page.fill('input[name="p_second_password"]', process.env.TEST_USER_PASSWORD);
    await page.click('button[type="submit"]');
    // Wait for redirect back to app
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Verify signed up', async () => {
    await page.waitForSelector('[data-testid="user-profile"]', { timeout: 10000 });
  });

  // Sign-in flow (sign out first to reset state)
  await flowStep('Sign out before sign-in test', async () => {
    await page.waitForSelector('[data-testid="sign-out-button"]', { timeout: 10000 });
    await page.click('[data-testid="sign-out-button"]');
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Click sign in', async () => {
    await page.waitForSelector('[data-testid="sign-in-button"]', { timeout: 10000 });
    await page.click('[data-testid="sign-in-button"]');
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Enter email', async () => {
    await page.waitForSelector('input[name="p_email"]', { timeout: 10000 });
    await page.fill('input[name="p_email"]', process.env.TEST_USER_EMAIL);
    await page.click('button[type="submit"]');
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Enter password', async () => {
    await page.waitForSelector('input[name="p_password"]', { timeout: 10000 });
    await page.fill('input[name="p_password"]', process.env.TEST_USER_PASSWORD);
    await page.click('button[type="submit"]');
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Verify signed in', async () => {
    await page.waitForSelector('[data-testid="user-profile"]', { timeout: 10000 });
  });

  // Sign-out flow
  await flowStep('Sign out', async () => {
    await page.waitForSelector('[data-testid="sign-out-button"]', { timeout: 10000 });
    await page.click('[data-testid="sign-out-button"]');
    await page.waitForNavigation({ waitUntil: 'networkidle0', timeout: 30000 });
  });

  await flowStep('Verify signed out', async () => {
    await page.waitForSelector('[data-testid="sign-in-button"]', { timeout: 10000 });
  });
};
```

## What's not supported

The following limitations apply to UI authentication flow testing:

- **Social provider flows**: Automated testing of Google, GitHub, or other social sign-in flows is not directly supported due to third-party provider restrictions
- **Enterprise SSO flows**: Testing SAML/SSO enterprise connections requires coordination with identity providers
- **MFA flows**: Testing multi-factor authentication may require manual intervention
- **Real email delivery**: Testing with real email addresses requires manual code entry (use test email services instead)

## Best practices

1. **Use data-testid attributes**: Add test IDs to your UI elements for reliable selectors
2. **Handle redirects gracefully**: Add appropriate waits for Kinde redirects (they can take time)
3. **Isolate test users**: Use separate test users for each test run when possible
4. **Clean up test data**: Delete test users or test data after test runs when possible
5. **Handle flakiness**: Add retry logic for network-related failures
6. **Use environment variables**: Store test credentials securely, never commit to source control

## Passwordless authentication flows

If your application uses passwordless authentication with email OTP, see the dedicated guide on **[Testing Passwordless Flows](/developer-tools/testing/testing-passwordless-flows/)**.
