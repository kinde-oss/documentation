---
page_id: 0a8277f3-d4c0-4d7a-9356-0c255f7c8d33
title: Set up a Next.js app with Prisma ORM and Kinde
description: Learn how to integrate Kinde authentication with a Next.js application and store user data in a Prisma-managed SQLite database.
sidebar:
  order: 10
relatedArticles:
  - 78f0242c-3a49-4c8d-8168-019fd69ef838
  - a07f8f6b-5d6a-4096-be52-7b13b4a3b0a5
  - 1023d9f8-ae2d-4167-98e0-a4aa7b31e80c
topics:
  - integrate
  - third-party-tools
sdk:
  - nextjs-sdk
languages:
  - typescript
  - javascript
  - sqlite
  - bash
audience:
  - developers
complexity: advanced
keywords:
  - prisma
  - nextjs
  - jwt
  - authentication
  - database
updated: 2025-11-12
featured: false
deprecated: false
ai_summary: Learn how to integrate Kinde authentication with a Next.js application and store user data in a Prisma-managed SQLite database.
---

Learn how to integrate Kinde authentication with a Next.js application and store user data in a Prisma-managed SQLite database. 

This guide will walk you through setting up the environment, installing dependencies, creating routes to handle authentication, and using Prisma Studio to view your database. 

By the end, you will have a fully functional authentication flow with user management capabilities, ready to be expanded for your application’s needs. Let's get started!

### What you need

- A [Kinde](https://kinde.com/) account (sign up for free)

## Step 1: Set up an application in Kinde

If you haven’t already set up an application in Kinde with Next.js, here’s the fastest way.

1. In Kinde, go to **Settings >** **Applications** and select **Add application**. 
2. Give the application a name and select **Back-end web**, then select **Save**. The **Quickstart** page opens.
3. Select **Next.js** as the framework and select **Save**.
4. Follow the relevant prompts for using a starter kit or connecting an existing codebase. When you’ve finished, proceed with Step 2 below.

![nextjs quick start](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/f8062c0b-eb6e-4b9c-f4f9-3383bafdb200/public)

## Step 2: Integrate Prisma ORM with your Next.js project

1. Install Prisma dependencies by entering the following commands in your project terminal:
    
    <PackageManagers pkg='-D prisma' />

    <PackageManagers pkg='@prisma/client' />
    
    These commands install:
    
    - `prisma` as a development dependency (includes the Prisma CLI)
    - `@prisma/client` as a runtime dependency (the Prisma Client for querying your database)
    
2. Initialize Prisma with SQLite as the database provider:
    
    ```bash
    npx prisma init --datasource-provider sqlite
    ```
    
    This command performs the following tasks:
    
    - Creates a `/prisma` directory with a `schema.prisma` file
    - Configures Prisma to use a SQLite database
    - Updates the `.env` file with a `DATABASE_URL` field set to `"file:./dev.db"`
    
3. Open the `/prisma/schema.prisma` file in your code editor. Replace its contents with the following code:
    
    In this project, you use SQLite, a simple file-based database stored on your computer. The schema defines a `User` model with fields for `id`, `kindeId`, `email`, `firstName`, and `lastName`, allowing your app to store user data locally.
    
    ```prisma
    generator client {
      provider = "prisma-client-js"
    }
    
    datasource db {
      provider = "sqlite"
      url      = env("DATABASE_URL")
    }
    
    model User {
      id        Int    @id @default(autoincrement())
      kindeId   String @unique
      email     String @unique
      firstName String
      lastName  String
    }
    ```

     <Aside>
      Don't forget to add `.env` and `.env.local` in the .gitignore file to not commit any private information.
     </Aside>

4. Run migrations and generate Prisma Client by running the following command:
    
    This command creates the database tables and generates the Prisma Client based on your schema.
    
    ```bash
    npx prisma migrate dev --name init
    ```
    
    This will:
    
    - Create a `prisma/migrations` directory with your initial migration
    - Apply the migration to create the database tables
    - Generate the Prisma Client automatically
    
    <Aside>
      For quick prototyping with SQLite, you can also use `npx prisma db push` instead of migrations. However, `prisma migrate dev` is recommended as it creates versioned migrations that can be tracked and applied consistently across environments. For more information, see the [Prisma migration guide](https://www.prisma.io/docs/guides/nextjs#24-run-migrations-and-generate-prisma-client).
    </Aside>
    
5. Set up Prisma Client by creating a new `lib` directory at the root of your project and adding a `prisma.ts` file:
    
    ```bash
    mkdir -p lib && touch lib/prisma.ts
    ```
    
    <Aside>
      If your Next.js project uses a `src` directory, create the `lib` directory inside `src` instead: `mkdir -p src/lib && touch src/lib/prisma.ts`. Adjust the import path accordingly.
    </Aside>
    
6. Open the `lib/prisma.ts` file and copy the following code into it. Save the file after adding the code:
    
    ```tsx
    import { PrismaClient } from "@prisma/client"

    const globalForPrisma = globalThis as unknown as {
      prisma: PrismaClient | undefined
    }

    export const prisma =
      globalForPrisma.prisma ??
      new PrismaClient({
        log: process.env.NODE_ENV === "development" ? ["query", "error", "warn"] : ["error"],
      })

    if (process.env.NODE_ENV !== "production") globalForPrisma.prisma = prisma

    export default prisma
    ```
    
    This code ensures that only one instance of the Prisma Client runs in your local development environment, preventing potential issues with multiple instances during hot reloading. The `globalThis` approach is recommended for modern Next.js applications. For more details, refer to the [Prisma Next.js guide](https://www.prisma.io/docs/guides/nextjs#26-set-up-prisma-client).

     <Aside>
      If you're using TypeScript, make sure your `tsconfig.json` has the path alias configured. The `@/lib/prisma` import assumes you have `"@/*": ["./*"]` (for root-level `lib`) or `"@/*": ["./src/*"]` (for `src/lib`) in your `tsconfig.json` paths. This is typically configured automatically when creating a Next.js project with TypeScript. For more information, see the [official Prisma Next.js guide](https://www.prisma.io/docs/guides/nextjs).
     </Aside>

## Step 3: Save user data to the database after authentication

1. Create a new directory named `success` inside the **app/api/auth/** directory (or **src/app/api/auth/** if using a `src` directory) by typing the following command in your terminal:
    
    ```bash
    mkdir -p app/api/auth/success
    ```
    
    <Aside>
      If your Next.js project uses a `src` directory, use `mkdir -p src/app/api/auth/success` instead.
    </Aside>
    
2. Create a `route.ts` file inside the newly created directory by running the following command.
    
    This file will act as a GET route to interface with the database and handle user authentication data.
    
    ```bash
    touch app/api/auth/success/route.ts
    ```
    
3. Open the `route.ts` file in your code editor, add the following code, and then save the file.
    
    ```tsx
    import prisma from "@/lib/prisma"
    import { getKindeServerSession } from "@kinde-oss/kinde-auth-nextjs/server"
    import { NextResponse } from "next/server"

    export async function GET() {
      try {
        const { getUser } = getKindeServerSession()
        const user = await getUser()

        if (!user || !user.id) {
          return NextResponse.json(
            { error: "Unauthorized" },
            { status: 401 }
          )
        }

        // Check if user already exists in database
        let dbUser = await prisma.user.findUnique({
          where: { kindeId: user.id },
        })

        // Create user if they don't exist
        if (!dbUser) {
          dbUser = await prisma.user.create({
            data: {
              kindeId: user.id,
              firstName: user.given_name ?? "",
              lastName: user.family_name ?? "",
              email: user.email ?? "",
            },
          })
        }

        // Redirect to dashboard after successful authentication
        const redirectUrl = process.env.KINDE_SITE_URL 
          ? `${process.env.KINDE_SITE_URL}/dashboard`
          : "http://localhost:3000/dashboard"
        return NextResponse.redirect(redirectUrl)
      } catch (error) {
        console.error("Error in auth success route:", error)
        return NextResponse.json(
          { error: "Internal server error" },
          { status: 500 }
        )
      }
    }
    ```
    
    When the code runs, it:
    
    - Imports the Prisma instance from the `lib/prisma.ts` file.
    - Imports functions to interact with the Kinde Server Session and handle the Next.js response.
    - Defines a **GET** route to retrieve the authenticated user's information.
    - Checks if the user is already stored in the database and creates a new user record if not.
    - Includes proper error handling and uses environment variables for the redirect URL.
4. Open the `.env` or `.env.local` file in your project and ensure you have the following environment variables configured:
    
    ```env
    DATABASE_URL="file:./dev.db"
    KINDE_POST_LOGIN_REDIRECT_URL=http://localhost:3000/api/auth/success
    KINDE_SITE_URL=http://localhost:3000
    ```
    
    The `DATABASE_URL` should already be set by Prisma init. The `KINDE_POST_LOGIN_REDIRECT_URL` ensures that after a successful login, the user is redirected to this route, which updates the database and then redirects the user. The `KINDE_SITE_URL` is used for constructing redirect URLs.
    
5. Go to the **Details** page of your Kinde dashboard and add `http://localhost:3000/api/auth/success` to the list of **Callback URLs.** 
6. Select **Save**.
    
    ![callback urls](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/05d49ca9-edfc-4ac0-e141-a52fa94bac00/public)
    

You’re now ready to test your database integration to ensure that user data is successfully stored and retrieved.

## Step 4: Test the Prisma integration

1. Start your development server by running the following command in your terminal:
    
    ```tsx
    	npm run dev
    ```
    
2. Open your web browser and navigate to [`http://localhost:3000`](http://localhost:3000/) to view your Kinde application. 
3. Select **Sign Up** to create a new user account. Enter the required details and complete the sign-up process.
4. Open your terminal and start the Prisma Studio by typing the following command:
    
    ```tsx
    npx prisma studio
    ```
    
    Prisma Studio is a visual tool for managing your database. It provides an intuitive interface to view, edit, and manage data in your database, making it easier to inspect records and make updates without writing SQL queries. It integrates directly with your Prisma schema, streamlining database interactions during development.
    
5. Go to [`http://localhost:5555`](http://localhost:5555/) in your web browser to access the Prisma studio and view your database.
6. In Prisma Studio, select the **User** model to see the newly registered user details.
    
    ![open model](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/f006d409-c719-4983-dd38-079bc7118b00/public)
    
    ![prisma studio](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/6c03901b-d597-4965-0d78-e992a2fa9200/public)
    

You have now stored the user details in your local database using Prisma.

### Congratulations

You've successfully set up Kinde authentication with your Next.js application and integrated it with Prisma for user management. You've also configured Prisma Studio to easily view and manage your database. 

With the user data now stored in your local database, you can build further features and enhance your application as needed.

For more information about using Prisma with Next.js, see the [official Prisma Next.js guide](https://www.prisma.io/docs/guides/nextjs). You can also explore more of [Prisma's documentation](https://www.prisma.io/docs) to continue refining your application's authentication and database integration.