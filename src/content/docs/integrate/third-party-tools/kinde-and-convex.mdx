---
page_id: f3dcba7f-fa4f-4ea1-a470-f03af04ba347
title: Kinde and Convex
description: Integrate Kinde with Convex to enable real-time user data sync and secure authentication with Kinde access tokens.
sidebar:
  order: 9
relatedArticles:
  - 78f0242c-3a49-4c8d-8168-019fd69ef838
  - a07f8f6b-5d6a-4096-be52-7b13b4a3b0a5
tableOfContents:
  maxHeadingLevel: 3
topics:
  - integrate
  - third-party-tools
sdk:
  - React.js
languages:
  - bash
  - typescript
  - json
audience:
  - developers
complexity: intermediate
keywords:
  - react
  - convex
  - express
  - authentication
  - database
  - webhooks
updated: 2026-02-25
featured: false
deprecated: false
ai_summary: Integrate Kinde with Convex to enable real-time user data sync and secure authentication with Kinde access tokens.
---

Bring real-time interactivity to your app with Convex, a powerful Backend-as-a-Service designed for dynamic React experiences.

## Quickstart

1. Set up a new React project by running the following command:

    ```bash
    npm create vite@latest my-app -- --template react-ts
    ```

2. Set up a [Kinde React application](/developer-tools/sdks/frontend/react-sdk/) and obtain the **Client ID** and **Kinde domain**

3. Install the Convex and Kinde React SDK dependencies:

    ```bash
    npm install convex @kinde-oss/kinde-auth-react
    ```

    Use the following command to sign-in to Convex and initialize a new project. Keep this terminal running for the development server.

    ```bash
    npx convex dev
    ```

4. Update your `main.tsx` file to include the Kinde and Convex providers:

    ```tsx
    // src/main.tsx
    import { StrictMode } from "react";
    import { createRoot } from "react-dom/client";
    import "./index.css";
    import App from "./App.tsx";
    import { KindeProvider } from "@kinde-oss/kinde-auth-react";
    import { ConvexProviderWithAuth, ConvexReactClient } from "convex/react";
    import useAuthFromKinde from "./hooks/useAuthFromKinde.ts";

    const convex = new ConvexReactClient(import.meta.env.VITE_CONVEX_URL as string);

    createRoot(document.getElementById("root")!).render(
      <StrictMode>
        <KindeProvider
          clientId="your_kinde_client_id"
          domain="https://your_kinde_business.kinde.com"
          logoutUri={window.location.origin}
          redirectUri={window.location.origin}
        >
          <ConvexProviderWithAuth client={convex} useAuth={useAuthFromKinde}>
            <App />
          </ConvexProviderWithAuth>
        </KindeProvider>
      </StrictMode>,
    );
    ```

    Create a new hook directory and add the following code to the hook:

    ```bash
    mkdir -p src/hooks
    touch src/hooks/useAuthFromKinde.ts
    ```

    ```tsx
    // src/hooks/useAuthFromKinde.ts
    import { useKindeAuth } from "@kinde-oss/kinde-auth-react";
    import { useCallback, useMemo } from "react";

    export default function useAuthFromKinde() {
      const { isLoading, isAuthenticated, getIdToken } = useKindeAuth();
      const fetchAccessToken = useCallback(
        async ({
          forceRefreshToken,
        }: {
          forceRefreshToken: boolean;
        }) => {
          void forceRefreshToken; // Convex passes this; Kinde's getIdToken() has no refresh option
          try {
            const response = await getIdToken();
            return response as string;
          } catch {
            return null;
          }
        },
        [getIdToken],
      );
      return useMemo(
        () => ({ isLoading, isAuthenticated, fetchAccessToken }),
        [isLoading, isAuthenticated, fetchAccessToken],
      );
    }
    ```

    <Aside type="warning" title="About the function name 'fetchAccessToken'">
      The function name `fetchAccessToken` is required by Convex even though it is sending the ID token. Naming the function anything else will result in an error in the browser console.
    </Aside>
    
5. Connect Convex backend auth by adding a `auth.config.ts` file:

    ```bash
    touch convex/auth.config.ts
    ```

    ```typescript
    // convex/auth.config.ts
    import { AuthConfig } from "convex/server";

    // domain must match the ID token's "iss"; applicationID must match the ID token's "aud".
    // Decode your ID token at jwt.io to confirm (use getIdToken() and paste the string).
    export default {
      providers: [
        {
          domain: "https://your_kinde_business.kinde.com",
          applicationID: "your_kinde_client_id",
        },
      ],
    } satisfies AuthConfig;
    ```
6. Add Convex auth utilities to your component: 

    ```tsx
    // src/App.tsx
    import "./App.css";
    import {
      LoginLink,
      LogoutLink,
      RegisterLink,
    } from "@kinde-oss/kinde-auth-react/components";
    import { useKindeAuth } from "@kinde-oss/kinde-auth-react";
    import { Authenticated, Unauthenticated, useConvexAuth } from "convex/react";

    function App() {
      const { user } = useKindeAuth();
      const { isLoading } = useConvexAuth();

      if (isLoading) {
        return <div>Loading...</div>;
      }

      return (
        <>
          <Authenticated>
            <div>
              Hello {user?.givenName} {user?.familyName}
              <br />
              Logged in | <LogoutLink>Sign out</LogoutLink>
            </div>
          </Authenticated>
          <Unauthenticated>
            <div>
              <LoginLink>Sign in</LoginLink>
              <RegisterLink>Sign up</RegisterLink>
            </div>
          </Unauthenticated>
        </>
      );
    }

    export default App;
    ```

    Learn more about adding custom OIDC providers to Convex in the [Convex documentation](https://docs.convex.dev/auth/advanced/custom-auth).


## Sync Kinde users to Convex database

When using Kinde’s ID token with Convex, the signed-in user’s claims are available in the token payload. Convex receives the Kinde ID in the `subject` claim, along with profile details such as `givenName`, `familyName`, `email`, etc. To use this data when the user is not logged in, store it in Convex. The steps below add a `users` table and a mutation that syncs the current user on sign-in.

1. Create and save the following Convex schema:

    ```bash
    touch convex/schema.ts
    ```

    ```typescript
    // convex/schema.ts
    import { defineSchema, defineTable } from "convex/server";
    import { v } from "convex/values";

    export default defineSchema({
      users: defineTable({
        kindeId: v.string(),
        givenName: v.optional(v.string()),
        familyName: v.optional(v.string()),
        email: v.optional(v.string()),
      }).index("by_kinde_id", ["kindeId"]),
    });
    ```
2. Create the `users` file and add the contents:

    ```bash
    touch convex/users.ts
    ```

    ```typescript
    // convex/users.ts
    import { v } from "convex/values";
    import { internalMutation, mutation, query } from "./_generated/server";

    export const store = mutation({
      args: {
        givenName: v.optional(v.string()),
        familyName: v.optional(v.string()),
        email: v.optional(v.string()),
      },
      handler: async (ctx, args) => {
        const identity = await ctx.auth.getUserIdentity();

        if (!identity) {
          throw new Error("Called storeUser without authentication present");
        }

        // Prefer Kinde user object (passed from client); fall back to JWT identity claims.
        const kindeProfile: Record<string, string> = {};
        const givenName = args.givenName ?? identity.givenName;
        const familyName = args.familyName ?? identity.familyName;
        const email = args.email ?? identity.email;
        if (givenName !== undefined) kindeProfile.givenName = givenName;
        if (familyName !== undefined) kindeProfile.familyName = familyName;
        if (email !== undefined) kindeProfile.email = email;

        // Check if we've already stored this identity before.
        const user = await ctx.db
          .query("users")
          .withIndex("by_kinde_id", (q) => q.eq("kindeId", identity.subject))
          .unique();

        if (user !== null) {
          if (Object.keys(kindeProfile).length > 0) {
            await ctx.db.patch(user._id, kindeProfile);
          }
          return user._id;
        }
        return await ctx.db.insert("users", {
          kindeId: identity.subject,
          ...kindeProfile,
        });
      },
    });
    ```

3. Update your `App.tsx` file with the contents:

    ```tsx
    // src/App.tsx
    import "./App.css";
    import {
      LoginLink,
      LogoutLink,
      RegisterLink,
    } from "@kinde-oss/kinde-auth-react/components";
    import { useKindeAuth } from "@kinde-oss/kinde-auth-react";
    import {
      Authenticated,
      Unauthenticated,
      useConvexAuth,
      useMutation,
    } from "convex/react";
    import { useEffect, useRef } from "react";
    import { api } from "../convex/_generated/api";

    function App() {
      const { user } = useKindeAuth();
      const { isLoading, isAuthenticated } = useConvexAuth();
      const storeUser = useMutation(api.users.store);
      const hasUpserted = useRef(false);

      useEffect(() => {
      // Only reset when clearly logged out (both sources agree). Avoids resetting when
      // Convex and Kinde resolve at different times and prevents upsert loops.
      if (!isAuthenticated && !user) {
        hasUpserted.current = false;
      }
      if (!isAuthenticated || !user) {
        return;
      }
      if (hasUpserted.current) return;
      storeUser({
        givenName: user.givenName,
        familyName: user.familyName,
        email: user.email,
      })
        .then(() => {
          hasUpserted.current = true;
        })
        .catch((error) => {
          console.error("Failed to store user:", error);
        });
      }, [isAuthenticated, user, storeUser]);

      if (isLoading) {
        return <div>Loading...</div>;
      }

      return (
        <>
          <Authenticated>
            <div>
              Hello {user?.givenName} {user?.familyName}
              <br />
              Logged in | <LogoutLink>Sign out</LogoutLink>
            </div>
          </Authenticated>
          <Unauthenticated>
            <div>
              <LoginLink>Sign in</LoginLink>
              <RegisterLink>Sign up</RegisterLink>
            </div>
          </Unauthenticated>
        </>
      );
    }

    export default App;

    ```

    The code will store the user data in the Convex database under the `users` table when the user signs in. 

    ![convex users database](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/d59004b6-fe09-4529-a441-83cfebae8d00/socialsharingimage)

    You can now query the user data in the Convex database using the `useQuery` hook.

    Learn more about using the `useQuery` hook in the [Convex React quickstart](https://docs.convex.dev/quickstart/react).

## Advanced user sync with Kinde webhooks

Right now, user data is written to Convex only when someone signs in. Changes made in Kinde elsewhere—for example in the Kinde dashboard, another app, or via the API—never reach Convex, so your database can go out of date. Use Kinde webhooks so that when a user is updated or deleted in Kinde, Convex is updated too. This section walks you through adding a webhook endpoint in your Convex backend and connecting it to Kinde.

<Aside type="upgrade">
The Kinde free plan includes one webhook, which is enough for this integration—you’ll use a single endpoint for user updates and deletions. If you need more webhooks later (e.g., for other apps or events), upgrade to a paid plan. [View plans](https://kinde.com/pricing/).
</Aside>

### Step 1: Configure Convex backend

1. In your Convex project, install the Kinde webhook library to validate the incoming webhook requests:

    ```bash
    npm install @kinde/webhooks
    ```

2. Update the `users.ts` file: ensure `internalMutation` is in your import from the Convex server (it already is from the earlier step), then add the following two functions after your existing `store` mutation:

    ```typescript
    // convex/users.ts
    // Keep your existing imports (v, internalMutation, mutation, query) and store mutation above, then add:

    /** Called from Kinde webhook on user.updated – look up by kindeId and patch schema fields. */
    export const updateUser = internalMutation({
      args: {
        data: v.any(),
      },
      handler: async (ctx, { data }) => {
        if (!data || typeof data.id !== "string") {
          throw new Error("updateUser: missing or invalid data.id (kinde user id)");
        }
        const user = await ctx.db
          .query("users")
          .withIndex("by_kinde_id", (q) => q.eq("kindeId", data.id))
          .unique();
        if (!user) return;
        const patch: Record<string, string> = {};
        if (typeof data.first_name === "string") patch.givenName = data.first_name;
        if (typeof data.last_name === "string") patch.familyName = data.last_name;
        if (typeof data.email === "string") patch.email = data.email;
        if (Object.keys(patch).length > 0) {
          await ctx.db.patch(user._id, patch);
        }
      },
    });

    /** Called from Kinde webhook on user.deleted – delete local user by kindeId. */
    export const deleteUser = internalMutation({
      args: {
        kindeId: v.string(),
      },
      handler: async (ctx, { kindeId }) => {
        const user = await ctx.db
          .query("users")
          .withIndex("by_kinde_id", (q) => q.eq("kindeId", kindeId))
          .unique();
        if (!user) return;
        await ctx.db.delete(user._id);
      },
    });

    ```

3. Create a new `webhook.ts` file and add the following contents:

    ```bash
    touch convex/webhook.ts
    ```

    ```typescript
    // convex/webhook.ts
    import { internal } from "./_generated/api";
    import { httpAction } from "./_generated/server";
    import { decodeWebhook } from "@kinde/webhooks";

    // Defining the webhook handler
    export const handleKindeWebhook = httpAction(async (ctx, request) => {
      try {
        const jwt = await request.text();

        const decoded = await decodeWebhook(jwt, process.env.KINDE_DOMAIN); // https://<your_kinde_business>.kinde.com

        if (!decoded) return new Response("Not a valid token", { status: 400 });

        const { data, type } = decoded;

        switch (type) {
          case "user.updated": {
            if (!data?.user) {
              return new Response("Missing user in webhook payload", {
                status: 400,
              });
            }
            await ctx.runMutation(internal.users.updateUser, {
              data: data.user,
            });
            break;
          }

          case "user.deleted": {
            if (!data?.user?.id) {
              return new Response("Missing user id in webhook payload", {
                status: 400,
              });
            }
            await ctx.runMutation(internal.users.deleteUser, {
              kindeId: data.user.id,
            });
            break;
          }

          default: {
            console.log("ignored Kinde webhook event", type);
            break;
          }
        }

        return new Response(null, { status: 200 });
      } catch (error) {
        console.error("Kinde webhook error:", error);
        return new Response("Internal server error", { status: 500 });
      }
    });

    ```

4. Create a new `http.ts` file and add the contents to handle the route:

    ```bash
    touch convex/http.ts
    ```

    ```typescript
    // convex/http.ts
    import { httpRouter } from "convex/server"
    import { handleKindeWebhook } from "./webhook"

    const http = httpRouter()

    // Configuring the webhook route
    http.route({
      path: "/kinde-users-webhook",
      method: "POST",
      handler: handleKindeWebhook,
    })

    export default http
    ```

    This will create a new backend route for your app under the `/kinde-users-webhook` path that will be listening for an incoming `POST` request from Kinde.

5. Go to your **Convex dashboard > Project > Settings > General > HTTP Actions URL** and copy the URL.
6. Combine the HTTP Actions URL with the `/kinde-users-webhook` path to get the full endpoint URL (e.g., `https://<http_actions_url>/kinde-users-webhook`). Copy this URL for the next step.
7. Go to your Convex project > **Settings** > **Environment Variables** and add the following environment variable:
    - `KINDE_DOMAIN`: The domain of your Kinde instance, you can find it in your Kinde application's **Details** page under **App keys** (e.g., `https://<your_kinde_business>.kinde.com`)
    
### Step 2: Set up a Kinde webhook

1. In your Kinde dashboard, go to **Settings > Webhooks** 
2. Select **Add webhook**
3. Enter the webhook **Name** and description
4. Add the **Endpoint URL.** (copied from earlier step) 
5. Scroll down and select **Add event**
6. Check the `user.updated`, and `user.deleted` events and select **Save** 
7. Select **Save** on the webhook creation page to finish creating the webhook
8. Go to **Users** and update a user's details or delete a user
9. Go to the **Convex dashboard** > **Data** > **Users** and verify that the user details are updated or the user is deleted in the database

## Tutorial: Create a real-time message board application with Kinde and Convex

This tutorial builds a simple message board: signed-in users post messages, and Convex’s real-time sync shows new messages to everyone as they’re sent—no refresh needed. You’ll add a `messages` table, send/list mutations and queries, and a small React UI that uses the synced user data from the previous sections.

1. Add the following messages schema to your Convex schema:

    ```typescript
    // convex/schema.ts
    export default defineSchema({
      // ... existing schema ...

      messages: defineTable({
        userId: v.string(),
        authorName: v.optional(v.string()),
        message: v.string(),
      }).index("by_user_id", ["userId"]),
    });
    ```

2. Create the messages file and add the contents:

    ```bash
    touch convex/messages.ts
    ```

    ```typescript
    // convex/messages.ts
    import { v } from "convex/values";
    import { mutation, query } from "./_generated/server";

    export const list = query({
      args: {},
      handler: async (ctx) => {
        return await ctx.db
          .query("messages")
          .order("desc")
          .take(100);
      },
    });

    export const sendMessage = mutation({
      args: {
        message: v.string(),
      },
      handler: async (ctx, args) => {
        const identity = await ctx.auth.getUserIdentity();
        if (!identity) {
          throw new Error("Must be authenticated to send a message");
        }
        const user = await ctx.db
          .query("users")
          .withIndex("by_kinde_id", (q) => q.eq("kindeId", identity.subject))
          .unique();
        if (!user) {
          throw new Error("User not found");
        }
        await ctx.db.insert("messages", {
          userId: user.kindeId,
          authorName: user.givenName ?? "Someone",
          message: args.message,
        });
      },
    });
    ```

    The above code creates two functions:
    - `list`: A query function that returns the last 100 messages from the database.
    - `sendMessage`: A mutation function that inserts a new message into the database.
    
3. Create a new component to create and display messages:

    ```bash
    touch src/MessageBoard.tsx
    ```

    ```tsx
    // src/MessageBoard.tsx
    import { useMutation, useQuery } from "convex/react";
    import { useState } from "react";
    import { api } from "../convex/_generated/api";

    export default function MessageBoard() {
      const messages = useQuery(api.messages.list);
      const sendMessage = useMutation(api.messages.sendMessage);
      const [message, setMessage] = useState("");

      async function handleSubmit(e: React.FormEvent) {
        e.preventDefault();
        const trimmed = message.trim();
        if (!trimmed) return;
        await sendMessage({ message: trimmed });
        setMessage("");
      }

      return (
        <section className="message-board">
          <h2 className="message-board-title">Message Board</h2>
          <ul className="message-list">
            {messages === undefined ? (
              <li className="message-item">Loading messages…</li>
            ) : messages.length === 0 ? (
              <li className="message-item">No messages yet. Send one below.</li>
            ) : (
              messages.map((m) => (
                <li key={m._id} className="message-item">
                  <span className="message-author">{m.authorName ?? "Someone"}:</span>
                  {m.message}
                </li>
              ))
            )}
          </ul>
          <form onSubmit={handleSubmit} className="message-form">
            <input
              type="text"
              className="message-input"
              value={message}
              onChange={(e) => setMessage(e.target.value)}
              placeholder="Type a message..."
              aria-label="Message"
            />
            <button type="submit" className="btn btn-primary" disabled={!message.trim()}>
              Send
            </button>
          </form>
        </section>
      );
    }
    ```

4. Add the optional styles to your CSS file:

    ```css
    /* src/App.css */
    :root {
      --kinde-primary: #111111;
      --kinde-primary-hover: #333333;
      --kinde-base: #1f2937;
      --kinde-base-muted: #6b7280;
      --kinde-bg: #ffffff;
      --kinde-bg-subtle: #f9fafb;
      --kinde-border: #e5e7eb;
      --kinde-radius: 8px;
      --kinde-font: system-ui, -apple-system, sans-serif;
    }

    /* Layout */
    #root {
      max-width: 640px;
      margin: 0 auto;
      padding: 2rem;
      font-family: var(--kinde-font);
      color: var(--kinde-base);
      background: var(--kinde-bg);
    }

    .app {
      min-height: 100vh;
    }

    .app-header {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--kinde-border);
      font-size: 0.9375rem;
      color: var(--kinde-base-muted);
    }

    .app-header strong {
      color: var(--kinde-base);
    }

    .auth-links a {
      color: var(--kinde-primary);
      text-decoration: none;
      font-weight: 500;
    }

    .auth-links a:hover {
      color: var(--kinde-primary-hover);
      text-decoration: underline;
    }

    .auth-links a + a {
      margin-left: 1rem;
    }

    .loading {
      color: var(--kinde-base-muted);
      padding: 2rem;
      text-align: center;
    }

    /* Message board */
    .message-board {
      background: var(--kinde-bg-subtle);
      border: 1px solid var(--kinde-border);
      border-radius: var(--kinde-radius);
      padding: 1.25rem;
    }

    .message-board-title {
      margin: 0 0 1rem;
      font-size: 1rem;
      font-weight: 600;
      color: var(--kinde-base);
    }

    .message-list {
      list-style: none;
      padding: 0;
      margin: 0 0 1rem;
      max-height: 40vh;
      overflow-y: auto;
    }

    .message-item {
      padding: 0.5rem 0.75rem;
      margin-bottom: 0.25rem;
      background: var(--kinde-bg);
      border-radius: 6px;
      font-size: 0.875rem;
      border: 1px solid var(--kinde-border);
    }

    .message-author {
      color: var(--kinde-primary);
      font-weight: 600;
      margin-right: 0.35rem;
    }

    .message-form {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.75rem;
    }

    .message-input {
      flex: 1;
      padding: 0.5rem 0.75rem;
      font-size: 0.875rem;
      font-family: inherit;
      border: 1px solid var(--kinde-border);
      border-radius: 6px;
      background: var(--kinde-bg);
      color: var(--kinde-base);
    }

    .message-input::placeholder {
      color: var(--kinde-base-muted);
    }

    .message-input:focus {
      outline: none;
      border-color: var(--kinde-primary);
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
    }

    /* Buttons – Kinde primary style */
    .btn {
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      font-weight: 500;
      font-family: inherit;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      transition: background-color 0.15s;
    }

    .btn-primary {
      background: var(--kinde-primary);
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: var(--kinde-primary-hover);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    ```

5. Update your `App.tsx` file to include the `MessageBoard` component: add `import MessageBoard from "./MessageBoard";` at the top, then render `<MessageBoard />` inside the `<Authenticated>` block (for example, after the greeting div that shows the user's name and sign-out link).

    ```tsx
    // src/App.tsx
    import MessageBoard from "./MessageBoard";

    <Authenticated>
        {/* ... existing code ... */}
        <MessageBoard />
    </Authenticated>
    ```

6. Run the application and test the message board:

    ```bash
    npm run dev
    ```
    
    Go to http://localhost:5173 and sign in or create a new account.
    
    You should see the message board with the ability to send messages.

    ![real time application with convex](https://imagedelivery.net/skPPZTHzSlcslvHjesZQcQ/c01de5d4-c76a-4b47-8e76-78ab2bb96e00/socialsharingimage)
